{"version":3,"sources":["+listBills.js","+orgChart.js","+totalsChart.js","+treeChart.js","+yearChart.js","+custom.js"],"names":["imgerror","image","style","display","sortCounts","objects","sortable","object","push","sort","a","b","switchGunBills","year","$","empty","billURL","subjects","text","getJSON","done","data","getPercentage","total","val","pct","Math","round","numberOfBills","statusArray","sponsorArray","partyArray","lobbiedArray","groupsArray","html","each","k","v","status","billDate","Date","parse","introduced","billNumberArray","number","split","toUpperCase","dateArray","monthNames","parseInt","title","purpose","join","console","log","lobbied","key","sponsor","last_name","govtrack_id","party","first_name","state","in_office","countObj","govtrack","append","$divs","dateOrderedDivs","attr","subjectCounts","_","countBy","subjectList","click","selected","this","toggleClass","hide","find","show","groupCounts","groupList","partyCounts","partyList","statusCounts","lobbiedCounts","sponsorCounts","obj","lobbiedTotal","barClass","inArray","gunControlGroups","statusTotal","partyTotal","buildOrgChart","orgMargin","left","right","top","bottom","width","height","d3","csvParse","max","d","minDate","min","maxDate","x","scaleLinear","domain","range","y","xAxis","axisBottom","tickFormat","format","yAxis","axisLeft","orgSvg","select","orgGroup","call","series","columns","slice","map","value","serie","selectAll","enter","line","defined","filter","buildTotalsChart","gunControlTotals","gunRightsTotal","grTotalPct","css","buildTreeChart","csvData","draw","leaves","id","x0","y0","x1","y1","splitArray","gunColors","substring","lastIndexOf","switchData","length","root","stratify","sum","treemap","scaleOrdinal","parentId","size","padding","firstYear","buildYearChart","yearChartSVG","margin","group","scaleBand","rangeRound","align","Year","nice","z","stack","categories","ticks","tickSize","pop","keys","bandwidth","legend","reverse","i","gunRightsGroups","document","ready","heroHeight","window","resize","removeClass","addClass","fadeOut","fadeIn","gunMoney","startYear","endYear","gunControlAnnuals","gunRightsAnnuals","gunOrgs","yearData","gunControl","spending","gunRights","index","name","uniqBy","gunOrgCounts","orgArray","csvOrgData","yearArray","toString","group1header","group2header","ind","orgIndex","expenditures","mainYear","forEach","getFullYear"],"mappings":"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","file":"scripts-bundle.js","sourcesContent":["//Hide any image that throws a 404\nfunction imgerror(image) {\n    image.style.display = 'none';\n}\n\n//Sort counts for objects\nfunction sortCounts(objects) {\n    var sortable = [];\n    for (var object in objects)\n        sortable.push([object, objects[object]]);\n    sortable.sort(\n        function(a, b) {\n            return b[1] - a[1];\n        }\n    );\n    return sortable;\n}\n\n//Switch gun bill info based on year\nfunction switchGunBills(year) {\n    //Clear out content\n    $('#bill-list').empty();\n\n    //Set data urls in one place\n    var billURL = \"data/gunBills\" + year + \".json\";\n    //var sponsorsURL = \"data/gunSponsors.json\";\n\n    //To hold parsed sponsor data\n    var sponsors = {};\n\n    //We're going to count who sponsored the most\n    var totalRepublicans = 0;\n    var totalDemocrats = 0;\n    var totalOther = 0;\n\n    //We're going to count by subject\n    var subjects = [];\n\n    //Stick year on end of heads\n    $(\".head-year\").text(year);\n\n    //Get bill information\n    $.getJSON(billURL).done(function(data) {\n\n        //Holds number fo bills\n        var numberOfBills = 0;\n        //Hold counts for each status\n        var statusArray = [];\n        //Hold counts for each sponsor\n        var sponsorArray = [];\n        //Hold counts for each party\n        var partyArray = [];\n        //Hold counts for each group\n        var lobbiedArray = [];\n        //Hold counts for each sponsor\n        var groupsArray = [];\n        //Hold counts for each subject\n        var subjectsArray = [];\n\n        //Reset list div\n        $('#bill-list').html(\"\")\n\n        $(\"#bill-groups\").empty().html(\"Groups:<br/>\");\n        $(\"#bill-parties\").empty().html(\"Party:<br/>\");\n        $(\"#bill-statuses\").empty().html(\"Status:<br/>\");\n        $(\"#bill-tags\").empty().html(\"Tags:<br/>\");\n\n        $.each(data, function(k, v) {\n            if (v[\"subjects-top-term\"] != \"Native Americans\" && v[\"subjects-top-term\"] != \"Animals\" && v[\"subjects-top-term\"] != \"Agriculture and food\" && v[\"subjects-top-term\"] != \"Economics and public finance\" && v[\"subjects-top-term\"] != \"Education\" && v[\"subjects-top-term\"] != \"Energy\" && v[\"subjects-top-term\"] != \"Labor and employment\" && v[\"subjects-top-term\"] != \"Private legislation\" && v[\"subjects-top-term\"] != \"Water resources development\") {\n\n                //Increment totals\n                numberOfBills++;\n                statusArray.push(v.status);\n                //sponsorArray.push(v.sponsor.first_name+\" \"+v.sponsor.last_name);\n\n                var billDate = Date.parse(v.introduced);\n\n                var html = \"\";\n                html += \"<div data-date='\" + billDate + \"'data-tag='\" + v[\"subjects-top-term\"] + \"' class='bill'>\";\n\n                //Bill number\n                billNumberArray = v.number.split(\"-\");\n                html += \"     <span class='bill-header bill-number'>\" + billNumberArray[0].toUpperCase() + \"</span>\";\n\n                //Date introduced\n                var dateArray = v.introduced.split(\"-\");\n                html += \"     <span class='bill-header bill-date'>\" + monthNames[(parseInt(dateArray[1]) - 1)] + \" \" + dateArray[2] + \", \" + dateArray[0] + \"</span>\";\n\n                //Bill subject used for tagging\n                html += \"     <span class='bill-tag'>\" + v[\"subjects-top-term\"] + \"</span>\";\n                subjects.push(v[\"subjects-top-term\"]);\n\n                //Short title if available\n                if (v[\"short-title\"]) {\n                    html += \"     <p class='bill-name'>\" + v[\"short-title\"] + \"</p>\";\n                } else {\n                    html += \"     <p class='bill-name'>\" + v.title + \"</p>\";\n                }\n\n                //Purpose if available\n                if (v.purpose != \"null\") {\n                    html += \"<p class='bill-purpose'>\" + v.purpose + \"</p>\";\n                } else {\n                    html += \"<p class='bill-purpose'>No purpose specified</p>\";\n                }\n                //Bill status\n                html += \"     <span class='bill-status'><strong>Status: </strong>\" + v.status.join(\" => \") + \"</span>\";\n\n                // Lobbied list\n                console.log(v.lobbied);\n                $.each(v.lobbied, function (key,val){\n                    lobbiedArray.push(val);\n                    groupsArray.push(val);\n               });\n                html += \"     <span class='sponsor-lobbied'><strong>Lobbied by: </strong> \" + v.lobbied.join(', ') + \"</span>\";\n\n\n                //Bill sponsor\n                if (v.sponsor.last_name) {\n\n                    html += \"     <div class='bill-sponsor'>\";\n                    html += \"     <strong>Sponsor</strong>\";\n\n                    //If govtrack then we have a photo\n                    if( v.sponsor.govtrack_id ){\n                        //Sponsor mug\n                        html += \"     <div class='mugBox clearFix\";\n                        if (v.sponsor.party === \"R\"){\n                            html += \" mugBoxR \";\n                        } else if (v.sponsor.party === \"D\"){\n                            html += \" mugBoxD \";\n                        }\n                         html += \"'><img class='bill-mug' src='https://www.govtrack.us/data/photos/\" + v.sponsor.govtrack_id + \"-100px.jpeg'/></div>\";\n                    }\n                    //Sponsor name\n                    if (v.sponsor.party === \"R\"){\n                        html += \"<span class='circle republican'/>\";\n                    } else if (v.sponsor.party === \"D\"){\n                        html += \"<span class='circle democrat'/>\";\n                    }\n\n                    //Hold parties for counting\n                    partyArray.push(v.sponsor.party);\n\n                    html += \"          <span class='sponsor-name'>\" + v.sponsor.title + \". \" + v.sponsor.first_name + \" \" + v.sponsor.last_name + \" (\" + v.sponsor.party + \"-\" + v.sponsor.state + \")</span>\";\n                    //Sponsor status\n                    if (v.sponsor.in_office === true) {\n                        html += \"<span class='sponsor-status'>Status: In office</span>\";\n                    } else {\n                        html += \"<span class='sponsor-status'>Status: Out of office</span>\";\n                    }\n\n                    html += \"     </div>\";\n\n                    var countObj = {};\n                    countObj.party = v.sponsor.party;\n                    countObj.govtrack = v.sponsor.govtrack_id;\n                    countObj.last_name = v.sponsor.last_name;\n                    countObj.first_name = v.sponsor.first_name;\n                    countObj.in_office = v.sponsor.in_office;\n                    sponsorArray.push(countObj);\n\n\n                } else {\n                    html += \"     <div class='bill-sponsor'>\";\n                    html += \"     <strong>Sponsor</strong>\";\n                    html += \"          <span class='sponsor-name'>No sponsor information available</span>\";\n                    html += \"     </div>\";\n                }\n\n\n                html += \"</div>\";\n\n                $('#bill-list').append(html);\n            }\n\n        });\n        $divs = $(\".bill\");\n\n        var dateOrderedDivs = $divs.sort(function(a, b) {\n            return $(a).attr(\"data-date\") - $(b).attr(\"data-date\");\n        });\n        $(\"#bill-list\").html(dateOrderedDivs);\n\n\n        //Build, display and activate subject tags\n        var subjectCounts = _.countBy(subjects);\n        //console.log(subjectCounts);\n\n        var subjectList = [];\n        $.each(subjectCounts, function(key, val) {\n            subjectList.push(key);\n        });\n        subjectList.sort();\n        $.each(subjectList, function(key, val) {\n            $(\"#bill-tags\").append(\"<span class='tag' data-tag='\" + val + \"'>\" + val + \"</span>\");\n        });\n\n        $(\".tag\").click(function() {\n            var selected = $(this).data(\"tag\");\n            $(this).toggleClass(\"selected-tag\");\n            $(\".bill\").hide();\n\n            console.log(selected);\n            $('#bill-list').find(\"[data-tag='\" + selected + \"']\").toggleClass(\"selected-tag\");\n            $(\".selected-tag\").show();\n        });\n\n        //Build, display and activate subject tags\n        var groupCounts = _.countBy(groupsArray);\n        console.log(groupCounts);\n\n        var groupList = [];\n        $.each(groupCounts, function(key, val) {\n            groupList.push(key);\n        });\n        groupList.sort();\n        $.each(groupList, function(key, val) {\n            $(\"#bill-groups\").append(\"<span class='tag' data-tag='\" + val + \"'>\" + val + \"</span>\");\n        });\n\n        //Build, display and activate subject tags\n        console.log(partyArray);\n        var partyCounts = _.countBy(partyArray);\n        console.log(partyCounts);\n\n        var partyList = [];\n        $.each(partyCounts, function(key, val) {\n            partyList.push(key);\n        });\n        partyList.sort();\n        $.each(partyList, function(key, val) {\n            $(\"#bill-parties\").append(\"<span class='tag' data-tag='\" + val + \"'>\" + val + \"</span>\");\n        });\n\n\n\n        //Do counts\n        //STATUS COUNTS\n        statusCounts = _.countBy(statusArray);\n        //console.log(statusCounts);\n\n        //ORG COUNTS\n        lobbiedCounts = _.countBy(lobbiedArray);\n        //console.log(lobbiedCounts);\n\n        //SPONSOR COUNTS\n        sponsorCounts = _.countBy(sponsorArray, function(obj){\n            return obj.last_name;\n        });\n\n        console.log(sponsorCounts);\n\n        // //Get top 3 sponsors\n        // sponsorCountsArray = sortable.slice(0, 3);\n        // console.log(sponsorCountsArray);\n\n        statusCounts = sortCounts(statusCounts);\n        partyCounts = sortCounts(partyCounts);\n        lobbiedCounts = sortCounts(lobbiedCounts);\n        sponsorCounts = sortCounts(sponsorCounts);\n\n        //console.log(lobbiedCounts);\n        //console.log(statusCounts);\n        //console.log(partyCounts);\n        console.log(sponsorCounts);\n\n        function getPercentage(total,val){\n            pct = val/total*100;\n            if (pct>95){\n                return 95;\n            } else {\n                return Math.round(pct);\n            }\n        }\n\n\n        $(\".byOrg\").empty().html(\"<h3>Organizations and the number of bills they lobbied</h3>\");\n        var lobbiedTotal;\n        $.each(lobbiedCounts, function(k, v) {\n            if (k === 0){\n                lobbiedTotal = 0;\n            }\n            lobbiedTotal += parseInt(v[1]);\n        });\n\n        $.each(lobbiedCounts, function(k, v) {\n            var barClass;\n             html = \"<div class='list-element'>\";\n             if ($.inArray(v[0], gunControlGroups) >= 0){\n                barClass = \"gc\";\n             } else {\n                barClass = \"gr\";\n             }\n             html += \"     <span class='list-item'>\"+v[0]+\"</span>\";\n             html += \"     <div class='bar-container'>\";\n             html += \"          <div class='list-bar \"+barClass+\"' style='width:\"+getPercentage(lobbiedTotal,v[1])+\"%'>&nbsp;</div><div class='bar-number'>\"+v[1]+\"</div>\";\n             html += \"     </div>\";\n             html += \"</div>\";\n            $(\".byOrg\").append(html);\n        });\n\n\n        // $(\".bySponsor\").empty().html(\"<h3>The top five sponsors of gun-related legislation</h3>\");\n        // for ( i=1; i<=5; i++){\n        //     if ( sponsorCounts[i][0] ){\n        //         //console.log(i);\n        //         html = \"<li>\"+sponsorCounts[i][0]+\": \" + sponsorCounts[i][1] + \" pieces of legislation.</li>\";\n        //         $(\".bySponsor\").append(html);\n        //     } else {\n        //         //console.log(i);\n        //     }\n        // }\n\n        $(\".byStatus\").empty().html(\"<h3>Status breakdown of introduced gun-related legislation</h3>\");\n        var statusTotal;\n        $.each(statusCounts, function(k, v) {\n            if (k === 0){\n                statusTotal = 0;\n            }\n            statusTotal += parseInt(v[1]);\n        });\n        $.each(statusCounts, function(k, v) {\n            html = \"<div class='list-element'>\";\n            html += \"     <span class='list-item'>\"+v[0]+\"</span>\";\n            html += \"     <div class='bar-container'>\";\n            html += \"          <div class='list-bar' style='width:\"+getPercentage(lobbiedTotal,v[1])+\"%;background:#BF531B'>&nbsp;</div><div class='bar-number'>\"+v[1]+\"</div>\";\n            html += \"     </div>\";\n            html += \"</div>\";\n            $(\".byStatus\").append(html);\n        });\n\n        $(\".byParty\").empty().html(\"<h3> Gun-related legislation introduced by party</h3>\");\n        var partyTotal;\n        $.each(partyCounts, function(k, v) {\n            if (k === 0){\n                partyTotal = 0;\n            }\n            partyTotal += parseInt(v[1]);\n            console.log(partyTotal);\n        });\n        $.each(partyCounts, function(k, v) {\n            console.log(v);\n            html = \"<div class='list-element'>\";\n            //console.log(v[0]);\n            switch (v[0]){\n                case \"R\":\n                    html += \"     <span class='list-item'>Republican</span>\";\n                    break;\n                case \"D\":\n                    html += \"     <span class='list-item'>Democrat</span>\";\n                    break;\n                case \"I\":\n                    html += \"     <span class='list-item'>Independent</span>\";\n                    break;\n                default:\n                    html += \"     <span class='list-item'>Other</span>\";\n                    break;\n            }\n\n            html += \"<div class='bar-container'>\";\n\n            switch (v[0]){\n                case \"R\":\n                    html += \"<div class='list-bar republican' style='width:\"+getPercentage(partyTotal,v[1])+\"%'>&nbsp;</div><div class='bar-number'>\"+v[1]+\"</div>\";\n                    break;\n                case \"D\":\n                    html += \"<div class='list-bar democrat' style='width:\"+getPercentage(partyTotal,v[1])+\"%'>&nbsp;</div><div class='bar-number'>\"+v[1]+\"</div>\";\n                    break;\n                default:\n                    html += \"<div class='list-bar \"+v[0]+\"' style='width:\"+getPercentage(partyTotal,v[1])+\"%'>&nbsp;</div><div class='bar-number'>\"+v[1]+\"</div>\";\n                    break;\n            }\n\n\n            html += \"     </div>\";\n            html += \"</div>\";\n            $(\".byParty\").append(html);\n        });\n\n\n    });\n}\n","function buildOrgChart(data) {\n    console.log(\"--------------   In buildOrgChart()  --------------\");\n    //console.log(data);\n    var gunColors = [\"#4295DE\", \"#D8322A\"];\n    /*\n    ----------------------------------------\n          INITIALIZE THE SVG CONTAINER\n    ----------------------------------------\n    */\n\n    var orgMargin = {left:50,right:50,top:40,bottom:40};\n    var width = $(\"#orgChart\").width();\n    var height = 500;\n\n    //Parse csv into array of objects\n    var data = d3.csvParse(data);\n    //console.log(data);\n    var max = d3.max(data,function(d){ return parseInt(d[\"Violence Policy Center\"])});\n    var minDate = d3.min(data,function(d){return parseInt(d.year);})\n    var maxDate = d3.max(data,function(d){return parseInt(d.year);})\n    var x = d3.scaleLinear()\n        .domain([minDate,maxDate])\n        .range([0,width]);\n    var y = d3.scaleLinear()\n        .domain([0,max])\n        .range([height,0]);\n    var xAxis = d3.axisBottom(x)\n        .tickFormat(d3.format(\"\"));\n    var yAxis = d3.axisLeft(y)\n        .tickFormat(d3.format(\".2s\"));\n\n    var orgSvg = d3.select(\"#orgChart\")\n        .append(\"svg\")\n            .attr(\"height\",height+orgMargin.bottom)\n            .attr(\"width\",width);\n\n    var orgGroup = orgSvg.append(\"g\")\n        .attr(\"transform\",\"translate(\"+orgMargin.left+\",10)\")\n\n    orgGroup.append(\"g\").attr(\"class\",\"x axis\").attr(\"transform\",\"translate(0,\"+height+\")\").call(xAxis);\n    orgGroup.append(\"g\").attr(\"class\",\"y axis\").call(yAxis);\n\n    var series = data.columns.slice(1).map(function(key) {\n        return data.map(function(d) {\n            return {\n                key: key,\n                year: d.year,\n                value: d[key]\n            };\n        });\n    });\n\n    //console.log(series);\n\n\n    var serie = orgGroup.selectAll(\".serie\")\n        .data(series)\n        .enter().append(\"g\")\n        .attr(\"class\", \"serie\");\n\n    serie.append(\"path\")\n        .attr(\"class\", \"line\")\n        .style(\"stroke\", function(d) { return d[0].key; })\n        .attr(\"d\", d3.line()\n        .x(function(d) { return y(d.year); })\n        .y(function(d) { return y(d.value); }));\n\n    var line = d3.line()\n        .defined(function(d) { //console.log(d);\n            if (d.value>0)return d; })\n        .y(function(d){return y(d.value);})\n        .x(function(d){return x(d.year)});\n\n    orgGroup.append(\"path\").attr(\"d\",line(data));\n\n    orgGroup.selectAll(\".dot\")\n        .data(data.filter(function(d) { if (d[\"Violence Policy Center\"]>0)return d; }))\n        .enter().append(\"circle\")\n        .attr(\"class\", \"dot\")\n        .attr(\"cx\", line.x())\n        .attr(\"cy\", line.y())\n        .attr(\"r\", 7);\n\n}\n","function buildTotalsChart(gunControlTotals, gunRightsTotal) {\n\n  console.log(\"--------------   In buildTotalsChart()  --------------\");\n  //console.log(\"gunControlTotals: \" + gunControlTotals);\n  //console.log(\"gunRightsTotal: \" + gunRightsTotal);\n\n  /*\n  <div class=\"bar\" id=\"grTotals\"></div>\n  <div class=\"bar\" id=\"gcTotals\"></div>\n  */\n\n  var total = gunControlTotals + gunRightsTotal;\n  var grTotalPct = Math.round(gunRightsTotal / total * 100);\n  //console.log(grTotalPct + \"%\");\n  $(\"#grBar\").css(\"width\", grTotalPct + \"%\");\n  $(\"#gcBar\").css(\"width\", 100-grTotalPct + \"%\");\n\n}\n","function buildTreeChart(csvData) {\n\n  function type(d) {\n    d.value = +d.value;\n    return d;\n  }\n\n  console.log(\"--------------   In buildTreeChart()  --------------\");\n\n  //console.log(csvData);\n\n  var width = $(\"#treeChart\").width();\n  var height = 500;\n\nvar gunColors = [\"#88C5F2\", \"#E3C357\"];\n\n  //var format = d3.format(\",d\");\n  var format = d3.format(\",.0f\");\n\n  var color = d3.scaleOrdinal()\n    .domain([\"gc\", \"gr\"])\n    .range(gunColors);\n\n  var stratify = d3.stratify()\n    .parentId(function (d) {\n      return d.id.substring(0, d.id.lastIndexOf(\".\"));\n    });\n\n  var treemap = d3.treemap()\n    .size([width, height])\n    .padding(1)\n    .round(true);\n\n  var data = d3.csvParse(csvData, function (d) {\n    var splitArray = d.id.split(\".\");\n    if (splitArray[1] === firstYear || splitArray.length == 1) {\n      return {\n        id: d.id, // lowercase\n        value: +d.value // lowercase\n      };\n    }\n  });\n\n  var root = stratify(data)\n    .sum(function (d) {\n      return d.value;\n    })\n    .sort(function (a, b) {\n      return b.height - a.height || b.value - a.value;\n    });\n\n  treemap(root);\n\n  function draw(data) {\n    $(\"#treeChart\").empty();\n    d3.select(\"#treeChart\")\n      .selectAll(\".node\")\n      .data(data.leaves())\n      .enter().append(\"div\")\n      .attr(\"class\", \"node\")\n      .attr(\"title\", function (d) {\n        return d.id + \"\\n\" + format(d.value);\n      })\n      .style(\"left\", function (d) {\n        return d.x0 + \"px\";\n      })\n      .style(\"top\", function (d) {\n        return d.y0 + \"px\";\n      })\n      .style(\"width\", function (d) {\n        return d.x1 - d.x0 + \"px\";\n      })\n      .style(\"height\", function (d) {\n        return d.y1 - d.y0 + \"px\";\n      })\n      .style(\"background\", function (d) {\n        var splitArray = d.id.split(\".\");\n        if (splitArray[2] === \"gr\") {\n          return gunColors[1];\n        } else {\n          return gunColors[0];\n        }\n      })\n      .append(\"div\")\n      .attr(\"class\", \"node-label\")\n      .text(function (d) {\n        var width = d.x1 - d.x0;\n        var height = d.y1 - d.y0;\n        if (width >= 80 && height >= 80) {\n          return d.id.substring(d.id.lastIndexOf(\".\") + 1).split(/(?=[A-Z][^A-Z])/g).join(\"\\n\");\n        }\n\n      })\n      .append(\"div\")\n      .attr(\"class\", \"node-value\")\n      .text(function (d) {\n        var width = d.x1 - d.x0;\n        var height = d.y1 - d.y0;\n        if (width >= 80 && height >= 80) {\n          return \"$\" + format(d.value);\n        }\n      });\n  }\n\n  draw(root);\n\n  function switchData(year) {\n\n    console.log(\"switchData(\" + year + \")\");\n\n    data = d3.csvParse(csvData, function (d) {\n      var splitArray = d.id.split(\".\");\n      if (splitArray[1] === year || splitArray.length == 1) {\n        return {\n          id: d.id, // lowercase\n          value: +d.value // lowercase\n        };\n      }\n    });\n    console.log(data);\n\n    root = stratify(data)\n      .sum(function (d) {\n        return d.value;\n      })\n      .sort(function (a, b) {\n        return b.height - a.height || b.value - a.value;\n      });\n    console.log(root);\n\n    treemap(root);\n\n    draw(root);\n\n  }\n\n  switchGunBills(firstYear);\n\n  //$(\"#yearSelector\").change(function () {\n    //var year = $(\"#yearSelector\").val();\n    $(\".year-list li\").click(function(){\n         var year = $(this).data(\"selectedyear\");\n         switchData(year);\n         switchGunBills(year);\n         console.log(year);\n    });\n\n\n}\n","function buildYearChart(data) {\n\n  console.log(\"--------------   In buildYearChart()  --------------\");\n  //console.log(data);\n\n  var width = $(\"#yearChart\").width();\n  var height = 500;\n\n  var gunColors = [\"#88C5F2\", \"#E3C357\"];\n\n  /*\n  ----------------------------------------\n        INITIALIZE THE SVG CONTAINER\n  ----------------------------------------\n  */\n\n  var yearChartSVG = d3.select(\"#yearChart\").append(\"svg\").attr(\"width\", width).attr(\"height\", height);\n  var margin = {\n    top: 5,\n    right: 0,\n    bottom: 17,\n    left: 25\n  };\n  width = width - margin.left - margin.right;\n  height = height - margin.top - margin.bottom;\n  group = yearChartSVG.append(\"g\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n\n  /* RANGES AND DOMAINS\n  ----------------------------------------\n                  X\n  ----------------------------------------\n  */ //Set the X range from 0 - width of div\n  var x = d3.scaleBand()\n    .rangeRound([0, width])\n    .padding(0.1)\n    .align(0.1);\n\n  //Set the X domain to the \"Year\" attribute\n  x.domain(data.map(function (d) {\n    return d.Year;\n  }));\n\n\n  /*\n  ----------------------------------------\n                  Y\n  ----------------------------------------\n  */ //Set the Y range from 0 - width of div\n  var y = d3.scaleLinear()\n    .rangeRound([height, 0]);\n\n  //Set the Y domain to the \"Total\" attribute\n  y.domain([0, d3.max(data, function (d) {\n    return d.total;\n  })]).nice();\n\n  /*\n  ----------------------------------------\n                  Z\n  ----------------------------------------\n  */ //Set the Z range which looks like color bars\n  var z = d3.scaleOrdinal()\n    .range([gunColors[0], gunColors[1]]);\n\n  //Set the Z domain or color key\n  z.domain([\"Gun Control\", \"Gun Rights\"]);\n\n  /*\n  ----------------------------------------\n                   Stack\n  ----------------------------------------\n  */ //sets the stack generator to \"stack\"\n  var stack = d3.stack();\n\n  /*\n  ----------------------------------------\n          Define the categories\n  ----------------------------------------\n  */ //Since the json has other attributes, manually set the ones to chart\n\n  var categories = [\"Gun Control\", \"Gun Rights\"];\n\n  group.append(\"g\")\n    .attr(\"class\", \"axis axis--x\")\n    .attr(\"transform\", \"translate(0,\" + height + \")\")\n    .call(d3.axisBottom(x));\n\n  group.append(\"g\")\n    .attr(\"class\", \"axis axis--y\")\n    .call(d3.axisLeft(y).ticks(10, \"s\").tickSize(width*-1))\n    .append(\"text\")\n    .attr(\"x\", 2)\n    .attr(\"y\", y(y.ticks(10).pop()))\n    .attr(\"dy\", \"0.35em\")\n\n\n  group.selectAll(\".serie\")\n    .data(stack.keys(categories)(data))\n    .enter().append(\"g\")\n    .attr(\"class\", \"serie\")\n    .attr(\"fill\", function (d) {\n      return z(d.key);\n    })\n    .selectAll(\"rect\")\n    .data(function (d) {\n      return d;\n    })\n    .enter().append(\"rect\")\n    .attr(\"x\", function (d) {\n      return x(d.data.Year);\n    })\n    .attr(\"y\", function (d) {\n      return y(d[1]);\n    })\n    .attr(\"height\", function (d) {\n      return y(d[0]) - y(d[1]);\n    })\n    .attr(\"width\", x.bandwidth());\n\n\n\n  /*\n  ----------------------------------------\n        Add the legend\n  ----------------------------------------\n  */ \n  var legend = group.selectAll(\".legend\")\n    .data(categories.reverse())\n    .enter().append(\"g\")\n    .attr(\"class\", \"legend\")\n    .attr(\"transform\", function (d, i) {\n      return \"translate(0,\" + i * 20 + \")\";\n    })\n    .style(\"font\", \"10px sans-serif\");\n\n  legend.append(\"rect\")\n    .attr(\"x\", 30)\n    .attr(\"y\", 30)\n    .attr(\"width\", 18)\n    .attr(\"height\", 18)\n    .attr(\"fill\", z);\n\n  legend.append(\"text\")\n    .attr(\"x\", 58)\n    .attr(\"y\", 38)\n    .attr(\"dy\", \".35em\")\n    .attr(\"text-anchor\", \"start\")\n    .text(function (d) {\n      return d;\n    });\n\n}\n","    var firstYear = \"2000\";\n    var monthNames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n    var gunControlGroups = [];\n    var gunRightsGroups = [];\n    \n    $(document).ready(function() {\n\n        $(\"#hero-gr\").hide();\n\n         //Get height of img\n         var heroHeight = $(\"#hero-gc\").height();\n         $(\"#hero\").height(heroHeight);\n\n        $( window ).resize(function() {\n             heroHeight = $(\"#hero-gc\").height();\n             $(\"#hero\").height(heroHeight);\n        });\n\n         //Switch theme button\n         $(\"#button-gc\").click(function(){\n             console.log(\"click\");\n              $(\".gr\").removeClass(\"gr\").addClass(\"gc\");\n              $(\".gr-dark\").removeClass(\"gr-dark\").addClass(\"gc-dark\");\n              $(\"#hero-gr\").fadeOut();\n              $(\"#hero-gc\").fadeIn();\n\n         });\n         $(\"#button-gr\").click(function(){\n             console.log(\"click\");\n              $(\".gc\").removeClass(\"gc\").addClass(\"gr\");\n              $(\".gc-dark\").removeClass(\"gc-dark\").addClass(\"gr-dark\");\n              $(\"#hero-gc\").fadeOut();\n              $(\"#hero-gr\").fadeIn();\n         });\n\n        $(\".handle\").click(function() {\n            $(this).toggleClass(\"slideRight\");\n            $(\".gun-control\").toggleClass(\"hide-gun-control\");\n            $(\".gun-rights\").toggleClass(\"hide-gun-rights\");\n        });\n\n        var gunMoney = \"data/gunOrgSpending.json\";\n\n        var startYear = 2000;\n        var endYear = 2016;\n\n        var gunControlAnnuals = {};\n        var gunRightsAnnuals = {};\n\n        var indices = [\"Gun Control\", \"Gun Rights\"];\n\n        //Array of unique gun orgs\n        var gunOrgs = [];\n\n        var yearData = [];\n\n        for (i = startYear; i <= endYear; i++) {\n             $(\".year-list\").append(\"<li data-selectedYear=\"+i+\">\"+i+\"</li>\");\n        }\n\n        $.getJSON(gunMoney).done(function(data) {\n\n            // Shortcut to groups\n            var gunControl = data.spending[0].gunControl;\n            var gunRights = data.spending[1].gunRights;\n\n            //Build arrays for each groups\n\n\n            /*---------------------------------------------------------------\n            \t\t\t BUILD ORG FEVERS csv\n            ---------------------------------------------------------------*/\n\n            //Build an array of ALL gun orgs\n            for (i = startYear; i <= endYear; i++) {\n                $.each(gunControl, function(index, value) {\n                    //console.log();\n                    $.each(value, function(index, value) {\n                        gunOrgs.push(value.name);\n                        //Add to group arrays for counting sides\n                        gunControlGroups.push(value.name);\n                    });\n                });\n                $.each(gunRights, function(index, value) {\n                    //console.log();\n                    $.each(value, function(index, value) {\n                        gunOrgs.push(value.name);\n                        //Add to group arrays for counting sides\n                        gunRightsGroups.push(value.name);\n                    });\n                });\n            }\n            gunControlGroups = _.uniqBy(gunControlGroups);\n            gunRightsGroups = _.uniqBy(gunRightsGroups);\n            console.log(gunRightsGroups);\n\n            //GUN ORG COUNTS\n            gunOrgCounts = _.countBy(gunOrgs);\n\n            //Build top line of gun orgs csv\n            //var csvOrgData = \"year,\";\n            var orgArray = [\"year\"];\n            $.each(gunOrgCounts, function(index, value) {\n                //csvOrgData += index+\",\";\n                orgArray.push(index);\n            });\n            var csvOrgData = orgArray + \"\\n\";\n\n\n\n            /*---------------------------------------------------------------\n            \t\t\t BUILD TREE MAP csv\n            ---------------------------------------------------------------*/\n\n            var csvData = \"id,value\\n\";\n            csvData += \"flare,\\n\";\n\n            for (i = startYear; i <= endYear; i++) {\n\n                //FOR GUN ORG CHART\n                yearArray = [i.toString()];\n\n                csvData += \"flare.\" + i.toString() + \",\\n\";\n                var group1header = false;\n                var group2header = false;\n                //console.log(i);\n                $.each(data.spending, function(index, value) {\n                    if (index === 0) {\n                        group = \"gc\";\n                        //console.log(\"     \"+group);\n                        //console.log(value.gunControl[i.toString()]);\n                        if (!group1header) {\n                            //console.log(\"false: \"+group1header);\n                            csvData += \"flare.\" + i.toString() + \".\" + group + \",\\n\";\n                            $.each(value.gunControl[i.toString()], function(ind, val) {\n                                //console.log(val.name);\n\n                                var orgIndex = $.inArray(val.name,orgArray);\n                                if (parseInt(val.expenditures) > 0){\n                                    yearArray[orgIndex] = val.expenditures;\n                                }\n\n                                csvData += \"flare.\" + i.toString() + \".\" + group + \".\" + val.name + \",\" + val.expenditures + \"\\n\";\n                            });\n                            group1header = true;\n                        }\n                    }\n                });\n                $.each(data.spending, function(index, value) {\n                    if (index === 1) {\n                        group = \"gr\";\n                        //console.log(\"     \"+group);\n                        //console.log(value.gunControl[i.toString()]);\n                        if (!group2header) {\n                            //console.log(\"false: \"+group2header);\n                            csvData += \"flare.\" + i.toString() + \".\" + group + \",\\n\";\n                            $.each(value.gunRights[i.toString()], function(ind, val) {\n                                //console.log(val.name);\n\n                                var orgIndex = $.inArray(val.name,orgArray);\n                                if (parseInt(val.expenditures) > 0){\n                                    yearArray[orgIndex] = val.expenditures;\n                                }\n\n\n                                csvData += \"flare.\" + i.toString() + \".\" + group + \".\" + val.name + \",\" + val.expenditures + \"\\n\";\n                            });\n                            group2header = true;\n                        }\n                    }\n                });\n                //console.log(yearArray);\n                csvOrgData += yearArray+\"\\n\";\n            }\n\n\n            /*---------------------------------------------------------------\n                        BUILD YEAR CHART json\n            ---------------------------------------------------------------*/\n\n            // Loop through every year\n            for (i = startYear; i <= endYear; i++) {\n\n                // Blank object to be pushed into yearData for first chart\n                mainYear = {};\n                mainYear.Year = i;\n\n                // Initialize annual totals to 0\n                gunRightsAnnuals[i] = 0;\n                gunControlAnnuals[i] = 0;\n\n                //console.log(\"    Gun Rights\");\n                gunRights[i.toString()].forEach(function(year) {\n                    //console.log(parseInt(year.expenditures));\n                    gunRightsAnnuals[i.toString()] += parseInt(year.expenditures);\n                });\n\n                //console.log(\"    Gun Control\");\n                gunControl[i.toString()].forEach(function(year) {\n                    //console.log(parseInt(year.expenditures));\n                    gunControlAnnuals[i.toString()] += parseInt(year.expenditures);\n                });\n\n\n\n                mainYear[\"Gun Control\"] = gunControlAnnuals[i.toString()];\n                mainYear[\"Gun Rights\"] = gunRightsAnnuals[i.toString()];\n                mainYear.total = parseInt(gunControlAnnuals[i.toString()]) + parseInt(gunRightsAnnuals[i.toString()]);\n\n                yearData.push(mainYear);\n\n            }\n\n            /*---------------------------------------------------------------\n                        BUILD TOTALS CHART\n            ---------------------------------------------------------------*/\n            var gunControlTotals = 0;\n            var gunRightsTotal = 0;\n\n            $.each(yearData, function(key, val) {\n                gunControlTotals += val[\"Gun Control\"];\n                gunRightsTotal += val[\"Gun Rights\"];\n            });\n\n            buildTotalsChart(gunControlTotals, gunRightsTotal);\n            buildYearChart(yearData);\n            buildOrgChart(csvOrgData);\n            buildTreeChart(csvData);\n\n        });\n\n        // injecting current year into footer\n        // DO NOT DELETE\n\n        var d = new Date();\n        var year = d.getFullYear();\n\n        $('.copyright').text(year);\n\n    });\n"]}